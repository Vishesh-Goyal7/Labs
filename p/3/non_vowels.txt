#include <mpi.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>


int main(int argc, char *argv[]) {
   int rank, size, res, l, chunk_size;
  
   MPI_Init(&argc, &argv);
   MPI_Comm_size(MPI_COMM_WORLD, &size);
   MPI_Comm_rank(MPI_COMM_WORLD, &rank);
  
   char string[100], *str;


   if (rank == 0) {
       printf("Enter string: ");
       scanf("%s", string);
       l = strlen(string);
       chunk_size = (l + size - 1) / size;  // Ensure even distribution
   }


   MPI_Bcast(&chunk_size, 1, MPI_INT, 0, MPI_COMM_WORLD);
  
   str = (char *)calloc(chunk_size + 1, sizeof(char)); // +1 for null terminator
   MPI_Scatter(string, chunk_size, MPI_CHAR, str, chunk_size, MPI_CHAR, 0, MPI_COMM_WORLD);
   str[chunk_size] = '\0'; // Null terminate the received portion


   int c = 0;
   for (int i = 0; i < chunk_size; i++) {
       if (str[i] != '\0' && strchr("aeiouAEIOU", str[i]) == NULL)
           c++;
   }


   printf("Process %d has %d non-vowels\n", rank, c);
  
   MPI_Reduce(&c, &res, 1, MPI_INT, MPI_SUM, 0, MPI_COMM_WORLD);
  
   if (rank == 0)
       printf("The total non-vowels are: %d\n", res);


   free(str);
   MPI_Finalize();
   return 0;
}
